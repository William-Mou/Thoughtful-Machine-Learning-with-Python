X-Account-Key: account5
X-UIDL: GmailId1287d4242097a772
X-Mozilla-Status: 0000
X-Mozilla-Status2: 00000000
X-Mozilla-Keys:                                                                                 
Delivered-To: mlsubscriber.tech@csmining.org
Received: by 10.142.81.20 with SMTP id e20cs551027wfb;
        Sun, 9 May 2010 06:30:15 -0700 (PDT)
Received: by 10.223.92.144 with SMTP id r16mr2763984fam.62.1273411814192;
        Sun, 09 May 2010 06:30:14 -0700 (PDT)
Return-Path: <bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org>
Received: from liszt.debian.org (liszt.debian.org [82.195.75.100])
        by mx.google.com with ESMTP id 24si6228506fav.7.2010.05.09.06.30.13;
        Sun, 09 May 2010 06:30:14 -0700 (PDT)
Received-SPF: pass (google.com: manual fallback record for domain of bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org designates 82.195.75.100 as permitted sender) client-ip=82.195.75.100;
Authentication-Results: mx.google.com; spf=pass (google.com: manual fallback record for domain of bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org designates 82.195.75.100 as permitted sender) smtp.mail=bounce-debian-user=mlsubscriber.tech=csmining.org@lists.debian.org
Received: from localhost (localhost [127.0.0.1])
	by liszt.debian.org (Postfix) with QMQP
	id 6C7096C8412; Sun,  9 May 2010 13:30:07 +0000 (UTC)
Old-Return-Path: <d_baron@012.net.il>
XChecker-Version: SpamAssassin 3.2.5 (2008-06-10) on liszt.debian.org
XLevel: 
XStatus: No, score=-2.7 required=4.0 tests=DNS_FROM_RFC_WHOIS,
	FVGT_m_MULTI_ODD,JOBS,LDO_WHITELIST,SARE_RECV_IP_080178 autolearn=no
	version=3.2.5
X-Original-To: lists-debian-user@liszt.debian.org
Delivered-To: lists-debian-user@liszt.debian.org
Received: from localhost (localhost [127.0.0.1])
	by liszt.debian.org (Postfix) with ESMTP id 577BB13A4F6D
	for <lists-debian-user@liszt.debian.org>; Sun,  9 May 2010 13:13:00 +0000 (UTC)
X-Virus-Scanned: at lists.debian.org with policy bank en-ht
X-AmavisStatus: No, score=-5.589 tagged_above=-10000 required=5.3
	tests=[BAYES_00=-2, FVGT_m_MULTI_ODD=0.02, JOBS=1, LDO_WHITELIST=-5,
	SARE_RECV_IP_080178=0.391] autolearn=no
Received: from liszt.debian.org ([127.0.0.1])
	by localhost (lists.debian.org [127.0.0.1]) (amavisd-new, port 2525)
	with ESMTP id PTtQqcy8vRqQ for <lists-debian-user@liszt.debian.org>;
	Sun,  9 May 2010 13:12:53 +0000 (UTC)
X-policyd-weight: using cached result; rate: -6.8
Received: from mtaout23.012.net.il (mtaout23.012.net.il [80.179.55.175])
	by liszt.debian.org (Postfix) with ESMTP id F28CC13A4EE4
	for <debian-user@lists.debian.org>; Sun,  9 May 2010 13:12:46 +0000 (UTC)
Received: from conversion-daemon.a-mtaout23.012.net.il by a-mtaout23.012.net.il (HyperSendmail v2007.08) id <0L2500I00M0TVC00@a-mtaout23.012.net.il> for debian-user@lists.debian.org; Sun, 09 May 2010 16:12:39 +0300 (IDT)
Received: from dovidhalevi ([80.230.220.224]) by a-mtaout23.012.net.il (HyperSendmail v2007.08) with ESMTPA id <0L2500GT3M0ZYY50@a-mtaout23.012.net.il> for debian-user@lists.debian.org; Sun, 09 May 2010 16:12:36 +0300 (IDT)
Received: from localhost ([127.0.0.1] helo=dovidhalevi.homelinux.net)	by dovidhalevi with esmtp (Exim 4.71)	(envelope-from <d_baron@012.net.il>)	id 1OB6JA-0004jB-Bu	for debian-user@lists.debian.org; Sun, 09 May 2010 16:12:36 +0300
Date: Sun, 09 May 2010 16:12:32 +0300
From: David Baron <d_baron@012.net.il>
Subject: Re: Shutdown problem -- cron job related?
In-reply-to: <20100509070020.ED79513A5808@liszt.debian.org>
X-012-Sender: d_baron@012.net.il
To: debian-user@lists.debian.org
Message-id: <201005091612.33337.d_baron@012.net.il>
MIME-version: 1.0
Content-type: Text/Plain; charset=utf-8
Content-transfer-encoding: 7bit
References: <20100509070020.ED79513A5808@liszt.debian.org>
User-Agent: KMail/1.13.3 (Linux/2.6.32-davidb; KDE/4.4.3; i686; ; )
X-Rc-Spam: 2008-11-04_01
X-Rc-Virus: 2007-09-13_01
X-Rc-Spam: 2008-11-04_01
Resent-Message-ID: <oBU5FOmoBTM.A.o-C.fjr5LB@liszt>
Resent-From: debian-user@lists.debian.org
X-Mailing-List: <debian-user@lists.debian.org> archive/latest/576270
X-Loop: debian-user@lists.debian.org
List-Id: <debian-user.lists.debian.org>
List-Post: <mailto:debian-user@lists.debian.org>
List-Help: <mailto:debian-user-request@lists.debian.org?subject=help>
List-Subscribe: <mailto:debian-user-request@lists.debian.org?subject=subscribe>
List-Unsubscribe: <mailto:debian-user-request@lists.debian.org?subject=unsubscribe>
Precedence: list
Resent-Sender: debian-user-request@lists.debian.org
Resent-Date: Sun,  9 May 2010 13:30:07 +0000 (UTC)

>> At certain times, seems Friday noontime, I am unable to shutdown the
>> system. Instead of the usual scripts to killing all processes, unmounting
>> everything and will now halt, goodby, I get:
>> 
>>  process running pstree (or something like that)
>>  shutdown aborted
>> 
>>  At this point, the system (or at least any console or UI) is dead.
>> 
>>  What it this?


> Just see which process is running pstree.
> "ps -eaf | grep pstree"
> You could find the parent pid of pstree (second column).
> Look at the parent of pstree, and the process started this one.
> If you go back that way, finally you will reach init, but before that you
> could find which system process started these processes.
I'll have to try it when I know the thing is running.

> As I recall, pstree is not part of basic installation.
> It was put to do some scripting, regarding found, in
> perl/python?
> My first bet would be to remove offensive cron line and
> shutdown normally. Than to do filesystem checks. Next,
> to set cron to use pstree as a regular user. I think that
> shutdown was done in some parts, aka closed network. What
> has to wait, hangs the system.
> Otherwise, there is a chance that some housekeeping pro-
> cesses are started at noon every day. You could always
> look at /etc directory and find them. Some unices have
> it in /etc/periodic/daily. It starts with #!/bin/sh.
> Another clue may be in /var/log, as a result of newsyslog.conf.

I have no /etc/periodic and no logs for pstree

I manually ran it (x11 variant) and this is what I got:
init-+-Xprt
     |-akonadi_control-+-akonadi_ical_re
     |                 |-8*[akonadi_kabc_re]
     |                 |-4*[akonadi_kcal_re]
     |                 |-42*[akonadi_maildir]
     |                 |-akonadi_maildis
     |                 |-akonadi_nepomuk---{akonadi_nepomu}
     |                 |-akonadi_vcard_r
     |                 |-akonadiserver-+-mysqld---74*[{mysqld}]
     |                 |               `-66*[{akonadiserver}]
     |                 `-4*[{akonadi_contro}]
     |-apmd
     |-atd
     |-avahi-daemon---avahi-daemon
     |-boinc
     |-clamd---2*[{clamd}]
     |-console-kit-dae---63*[{console-kit-da}]
     |-cron
     |-cupsd
     |-das_watchdog---{das_watchdog}
     |-3*[dbus-daemon]
     |-2*[dbus-launch]
     |-ddclient
     |-dirmngr
     |-dovecot-+-2*[dovecot-auth]
     |         |-imap
     |         |-3*[imap-login]
     |         `-3*[pop3-login]
     |-exim4
     |-fail2ban-server---6*[{fail2ban-serve}]
     |-fetchmail
     |-2*[getty]
     |-gpm
     |-hald-+-hald-runner-+-hald-addon-inpu
     |      |             `-hald-addon-stor
     |      `-{hald}
     |-in.tftpd
     |-inetd
     |-jackdbus
     |-kaccess
     |-kded4---{kded4}
     |-kdeinit4-+-kio_file
     |          |-kio_http_cache_
     |          |-kio_imap4
     |          |-klauncher
     |          |-ksmserver-+-kwin
     |          |           `-{ksmserver}
     |          |-python---python---python
     |          `-qjackctl---{qjackctl}
     |-kdm-+-Xorg
     |     `-kdm---startkde-+-kwrapper4
     |                      `-2*[ssh-agent]
     |-kget
     |-kglobalaccel
     |-klipper
     |-klogd
     |-kmail---{kmail}
     |-kmix
     |-knemo
     |-knotify4
     |-korgac---{korgac}
     |-krunner---{krunner}
     |-kxkb---{kxkb}
     |-nepomukserver
     |-plasma-desktop-+-ksysguardd
     |                `-7*[{plasma-desktop}]
     |-portmap
     |-postmaster-+-postmaster
     |            `-postmaster---postmaster
     |-preload
     |-proftpd
     |-rpc.mountd
     |-rpc.statd
     |-smartd
     |-spamd---2*[spamd]
     |-sshd
     |-svscanboot-+-readproctitle
     |            `-svscan
     |-syslogd
     |-tinyproxy---11*[tinyproxy]
     |-udevd---2*[udevd]
     |-xfs
     |-xfstt
     `-yakuake-+-bash---pstree.x11
               `-{yakuake}
Press return to close

Which would basically reflect what init ran and what kde4 is doing when I did 
it. Why would this be stuck at the end?


-- 
To UNSUBSCRIBE, email to debian-user-REQUEST@lists.debian.org 
with a subject of "unsubscribe". Trouble? Contact listmaster@lists.debian.org
Archive: http://lists.debian.org/201005091612.33337.d_baron@012.net.il


